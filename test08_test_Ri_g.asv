clear;

Kv_iso = 1e-3;
Nz = 100;
H  = 25; % m

dt = 10*60;

m = Model(H, Nz, Kv_iso, dt);

u = m.state.u * 0;
v = m.state.v * 0;
b = m.state.b * 0;

b = 0.1 * m.grid.z_T;

shear_bnd = [-5 -15];
x = (m.grid.z_T - shear_bnd(1)) / (shear_bnd(2) - shear_bnd(1));
u = 1 - 3 * x.^2 + 2 * x.^3;
u(m.grid.z_T > shear_bnd(1)) = 1;
u(m.grid.z_T <= shear_bnd(2)) = 0;

a

Ri_g = m.kpp.calGradientRichardsonNumber(m.grid, b, u, v);

subplot(1, 4, 1);
plot(b, m.grid.z_T);
title("b");

subplot(1, 4, 2);
plot(u, m.grid.z_T);
title("u");

subplot(1, 4, 3);
plot(v, m.grid.z_T);
title("v");

subplot(1, 4, 4);
plot(Ri_g, m.grid.z_W);
title("Ri_g");
xlim([-1 1])